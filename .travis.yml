# see http://about.travis-ci.org/docs/user/languages/php/ for more hints
language: php

 branches:
   except:
     - /^bugfix\/.*$/
     - /^feature\/.*$/
     - /^optimization\/.*$/
 
 os:
  linux
  
  php:
    - '7.0'
    - '7.1'
    - '7.2'
install:
    - composer install      
# optionally specify a list of environments, for example to test different RDBMS
env:
  - DB=mysql
  - DB=pgsql

install:
- export COMPOSER_ROOT_VERSION=dev-master
   - if [ "$DEPENDENCIES" != "low" ]; then composer update; fi;
   - if [ "$DEPENDENCIES" == "low" ]; then composer update --prefer-lowest; fi;

before_script:
  
  - if [[ "$DB" == "mysql" ]]; then mysql -e "create database IF NOT EXISTS hello_world_test;" -uroot; fi

# omitting "script:" will default to phpunit
# use the $DB env variable to determine the phpunit.xml to use
script: 

  - wget -O box.phar https://github.com/box-project/box2/releases/download/2.7.5/box-2.7.5.phar
  - php -d phar.readonly=0 box.phar build && sudo mv dix.phar /usr/local/bin/dix && sudo chmod +x /usr/local/bin/dix
  - vendor/bin/phpunit
  - phpunit --configuration phpunit_$DB.xml --coverage-text
  #- vendor/bin/phpspec run -fpretty -v
  #- vendor/bin/phpunit
 
